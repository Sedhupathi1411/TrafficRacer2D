(()=>{"use strict";var t,e={101:function(t,e){var r=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};function o(t){return r(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,fetch(t)];case 1:return[4,e.sent().json()];case 2:return[2,e.sent()]}}))}))}function i(t){var e=new Image;return new Promise((function(r){e.src=t,e.onload=function(){return r(e)}}))}Object.defineProperty(e,"__esModule",{value:!0}),e.Assets=e.loadImage=e.loadJSON=void 0,e.loadJSON=o,e.loadImage=i;var s=function(){function t(){}return t.Load=function(){return r(this,void 0,void 0,(function(){var t,e;return n(this,(function(r){switch(r.label){case 0:return t=this,[4,o("./assets/atlas.json")];case 1:return t.FRAMES=r.sent(),e=this,[4,i("./assets/atlas.png")];case 2:return e.IMG=r.sent(),console.log("Assets Loaded!"),[2]}}))}))},t}();e.Assets=s},316:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.BG=void 0;var s=r(101),a=r(198),c=r(593),l=function(t){function e(e){return t.call(this,"coin")||this}return o(e,t),e.prototype.everyTsec=function(t){a.CollisionObjs.push(this.createChild((0,c.chooseRandom)(Object.keys(s.Assets.FRAMES).filter((function(t){return t.match(/props\/coin/)}))),t))},e}(a.BaseCollisionObjManager);e.BG=function(){function t(){}return t.Init=function(t,e){this.coins=new l(e),this.roadFrame=s.Assets.FRAMES.road;var r=(e.width-t)/2;e.laneStartX=r,e.laneSize=t/5;for(var n=-1;n<e.height/150;n++)this.roadsArr.push([r,150*n,t,150])},t.render=function(t){var e;t.ctx.save(),t.ctx.fillStyle="#0FB600",t.ctx.fillRect(0,0,t.width,t.height),t.ctx.restore(),this.roadsArr[this.roadsArr.length-1][1]>=t.height&&this.roadsArr.pop(),this.roadsArr[0][1]>=0&&this.roadsArr.unshift([this.roadsArr[0][0],-this.roadsArr[0][3],this.roadsArr[0][2],this.roadsArr[0][3]]);for(var r=0;r<this.roadsArr.length;r++)this.roadsArr[r][1]+=t.SPEED,(e=t.ctx).drawImage.apply(e,i(i([s.Assets.IMG],this.roadFrame,!1),[this.roadsArr[r][0],this.roadsArr[r][1],this.roadsArr[r][2],this.roadsArr[r][3]],!1));this.coins.render(t)},t.postRender=function(t){var e,r="Coins: "+t.coins+" ";t.ctx.save();var n=25;t.ctx.font="25px consolas";var o=t.ctx.measureText(r);t.ctx.fillText(r,t.width-o.width,n),(e=t.ctx).drawImage.apply(e,i(i([s.Assets.IMG],s.Assets.FRAMES["props/coin1"],!1),[t.width-(o.width+n+10),n/4,n,n],!1)),r=" Score: "+t.score,t.ctx.fillText(r,0,n),t.ctx.restore()},t.roadsArr=[],t}()},665:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.CarManager=void 0;var i=r(101),s=r(198),a=r(593),c=function(t){function e(e){return t.call(this,"car")||this}return o(e,t),e.prototype.everyTsec=function(t){for(var e=Math.round(1*Math.random())+1,r=0;r<e;r++)s.CollisionObjs.push(this.createChild((0,a.chooseRandom)(Object.keys(i.Assets.FRAMES).filter((function(t){return t.match(/cars\//)}))),t))},e}(s.BaseCollisionObjManager);e.CarManager=c},198:function(t,e,r){var n=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.checkCollisions=e.BaseCollisionObjManager=e.CollisionObjs=e.BaseCollisionObj=void 0;var o=r(101),i=r(593),s=function(){function t(t,e,r,n){if(void 0===n&&(n=[0,0]),this.type=t,this.dir=[0,0],this.speed=3,this.frame=o.Assets.FRAMES[e],this.width=Math.round(this.frame[i.W]*r.scale),this.height=Math.round(this.frame[i.H]*r.scale),this.pos=n,"car"==this.type||"player"==this.type){var s=e.split(""),a=s[s.length-1];e.match("big-truck")?this.shadowFrame=o.Assets.FRAMES["shadows/big-truck"]:e.match("small-truck")?this.shadowFrame=o.Assets.FRAMES["shadows/small-truck"]:this.shadowFrame=o.Assets.FRAMES["shadows/car"+a]}}return t.prototype.render=function(t){var e,r;this.shadowFrame&&(t.ctx.save(),(e=t.ctx).drawImage.apply(e,n(n([o.Assets.IMG],this.shadowFrame,!1),(0,i.scaleFrame)(n(n([],this.pos,!0),[this.width,this.height],!1),1.2),!1)),t.ctx.restore()),(r=t.ctx).drawImage.apply(r,n(n(n([o.Assets.IMG],this.frame,!1),this.pos,!1),[this.width,this.height],!1))},t.prototype.update=function(t){this.pos[i.Y]+=this.dir[i.Y]*this.speed},t}();e.BaseCollisionObj=s,e.CollisionObjs=[];var a=function(){function t(t){this.type=t,this.elapsedT=0}return t.prototype.createChild=function(t,r){var n=r.laneStartX+Math.round(4*Math.random())*r.laneSize,a=new s(this.type,t,r,[n+r.laneSize/2-o.Assets.FRAMES[t][i.W]*r.scale/2,-o.Assets.FRAMES[t][i.H]*r.scale]);a.dir[i.Y]=1,a.speed=r.SPEED-2;for(var l=0;l<e.CollisionObjs.length;l++)if(c(e.CollisionObjs[l],a)){a=this.createChild(t,r);break}return a},t.prototype.render=function(t){for(var r=0;r<e.CollisionObjs.length;r++)e.CollisionObjs[r].update(t),e.CollisionObjs[r].pos[i.Y]>t.height?(e.CollisionObjs.splice(r,1),r--):e.CollisionObjs[r].render(t);this.elapsedT++,this.elapsedT>50&&(this.elapsedT=0,this.everyTsec(t))},t}();function c(t,e){var r=t.pos[0],n=t.pos[1],o=t.width,i=t.height,s=e.pos[0],a=e.pos[1],c=e.width,l=e.height;return(r<s&&r+o>s||s<r&&s+c>r)&&(n<a&&n+i>a||a<n&&a+l>n)}e.BaseCollisionObjManager=a,e.checkCollisions=function(t){for(var r=0;r<e.CollisionObjs.length;r++)c(e.CollisionObjs[r],t.player)&&("car"==e.CollisionObjs[r].type?t.GAME_OVER():"coin"==e.CollisionObjs[r].type&&(t.onCoinCatch(e.CollisionObjs[r]),e.CollisionObjs.splice(r,1),r--))}},769:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function a(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var i=r(101),s=r(316),a=r(665),c=r(251),l=r(198),h=document.querySelector(".home-page"),u=document.querySelector(".game-over");e.Game=function(){function t(){}var e;return t.Load=function(){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,i.Assets.Load()];case 1:return t.sent(),[2]}}))}))},t.Init=function(){this.Resize(),this.roadWidth=this.width-100,this.scale=this.roadWidth/i.Assets.FRAMES.road[2],s.BG.Init(this.roadWidth,this),this.cars=new a.CarManager(this),this.player=new c.Player("cars/red3",this),h.style.width="0%",h.style.height="0%"},t.Loop=function(){var t=this;this.ctx.clearRect(0,0,this.width,this.height),s.BG.render(this),this.cars.render(this),this.player.render(this),this.player.update(this),s.BG.postRender(this),(0,l.checkCollisions)(this),this.score+=1,this.isLooping&&requestAnimationFrame((function(){return t.Loop()}))},t.Resize=function(){var t=innerWidth<innerHeight?innerWidth:Math.floor(2*innerHeight/3);this.width=this.canvas.width=t,this.canvas.style.width=t+"px",this.height=this.canvas.height=innerHeight,console.log("Window sized")},t.onCoinCatch=function(t){this.coins+=1},t.GAME_OVER=function(){console.log("GAME OVER!"),this.isLooping=!1,u.style.width="100%",u.style.height="100%",window.onclick=function(){return document.location.reload()}},e=t,t.canvas=document.querySelector("canvas"),t.ctx=e.canvas.getContext("2d"),t.SPEED=5,t.score=0,t.coins=0,t.isLooping=!1,t.events={keyDown:function(e){t.player.dir.every((function(t){return 0==t}))&&("ArrowLeft"==e.code?t.player.dir=[-1,0]:"ArrowRight"==e.code?t.player.dir=[1,0]:"ArrowUp"==e.code?t.player.dir=[0,-1]:"ArrowDown"==e.code&&(t.player.dir=[0,1]))},keyUp:function(e){("ArrowLeft"==e.code&&-1==t.player.dir[0]||"ArrowRight"==e.code&&1==t.player.dir[0]||"ArrowUp"==e.code&&-1==t.player.dir[1]||"ArrowDown"==e.code&&1==t.player.dir[1])&&(t.player.dir=[0,0])},touchStart:function(e){var r=e.touches[0].clientX;r<t.width/2?t.player.dir=[-1,0]:r>t.width/2&&(t.player.dir=[1,0])},touchEnd:function(e){t.player.dir=[0,0]}},t}()},251:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Player=void 0;var i=r(316),s=function(t){function e(e,r,n){var o=t.call(this,"player",e,r)||this;return o.accSpeed=5,o.pos=[r.width/2-o.width/2,r.height-2*o.height],o}return o(e,t),e.prototype.update=function(t){(this.pos[0]+this.width+15<i.BG.roadsArr[0][0]+i.BG.roadsArr[0][2]||-1==this.dir[0])&&(this.pos[0]-15>i.BG.roadsArr[0][0]||1==this.dir[0])&&(this.pos[0]+=this.dir[0]*this.accSpeed),(this.pos[1]>50||1==this.dir[1])&&(this.pos[1]+this.height<t.height-50||-1==this.dir[1])&&(this.pos[1]+=this.dir[1]*this.speed)},e}(r(198).BaseCollisionObj);e.Player=s},593:(t,e)=>{function r(t,e,r){void 0===r&&(r=1);var n=Math.floor((e-t)/r);return Math.round(Math.random()*n)*r}Object.defineProperty(e,"__esModule",{value:!0}),e.scaleFrame=e.chooseRandom=e.getRandomElts=e.random=e.H=e.W=e.Y=e.X=void 0,e.X=0,e.Y=1,e.W=2,e.H=3,e.random=r,e.getRandomElts=function(t,e){for(var n=Array.from(t),o=[],i=0;i<e;i++)o.push.apply(o,n.splice(r(0,n.length-1),1));return o},e.chooseRandom=function(t){return t[r(0,t.length-1)]},e.scaleFrame=function(t,e){var r=e-1;return[t[0]-t[2]*r/2,t[1]-t[3]*r/2,t[2]*e,t[3]*e]}}},r={};t=function t(n){var o=r[n];if(void 0!==o)return o.exports;var i=r[n]={exports:{}};return e[n].call(i.exports,i,i.exports,t),i.exports}(769),window.onload=function(){t.Game.Load().then((function(){document.body.querySelector(".home-page div h2").innerHTML="Tap to Play",window.onclick=function(){return t.Game.Init(),t.Game.isLooping=!0,t.Game.Loop(),window.onclick=function(){},window.onresize=function(){return t.Game.Resize()},void(navigator.userAgent.match("Mobile")?(window.ontouchstart=function(e){return t.Game.events.touchStart(e)},window.ontouchend=function(e){return t.Game.events.touchEnd(e)}):(window.onkeydown=function(e){return t.Game.events.keyDown(e)},window.onkeyup=function(e){return t.Game.events.keyUp(e)}))}}))},console.log("IS ANYTHING?"),console.log("IS ANYTHING?")})();